define("databaseEditor/mixins/dbEditorApiContextMixin",["react"],function(a){"use strict";return{contextTypes:{dbEditorApi:a.PropTypes.object.isRequired},getDbEditorApi:function(){return this.context.dbEditorApi}}}),define("databaseEditor/components/itemDetails.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){var d=this.getImageDef();return a.createElement("span",{key:"item-img-container",className:b.keys(b.pick({"item-thumb-img":!0,noImage:!d.imageValid},b.identity)).join(" ")},d.imageValid?a.createElement("img",b.assign({},{key:"item-img-thumb"},d.props)):null,d.imageValid?null:a.createElement(c.symbol,{name:"camera",key:"item-img-symbol"}))}return function(){return a.createElement("div",{className:"item-details",onClick:this.editItem},this.props.showImage&&this.getImageDef().imageVisible?d.apply(this,[]):null,a.createElement("span",{className:"item-title"},this.props.item.title||"(Untitled Item)"))}}),define("databaseEditor/components/itemDetails",["lodash","react","util","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/itemDetails.rt"],function(a,b,c,d,e){"use strict";function f(b,c){return a.find(b,function(b,d){return"wix:Image"===b._type&&a.includes(c,d)})}function g(a,b){var d={uri:a.src,width:a.width,height:a.height},e=c.imageTransform.getData(c.imageTransform.fittingTypes.SCALE_TO_FILL,{width:d.width,height:d.height,id:d.uri},{width:43,height:43,alignment:c.imageTransform.alignTypes.CENTER,htmlTag:"img"});return{src:b.getServiceTopology().staticMediaUrl+"/"+e.uri,style:e.css.img}}return b.createClass({displayName:"itemDetails",mixins:[c.translationMixin,d],propTypes:{item:b.PropTypes.object.isRequired,showImage:b.PropTypes.bool,visibleFields:b.PropTypes.arrayOf(b.PropTypes.string)},getDefaultProps:function(){return{showImage:!0}},getImageDef:function(){var b=f(this.props.item,this.props.visibleFields),c=!!b,d=c&&!a.isEmpty(b.src),e=d?g(b,this.getDbEditorApi()):null;return{imageVisible:c,imageValid:d,props:e}},editItem:function(){this.getDbEditorApi().setCurrentItem(this.props.item._iid,"hover_item")},render:e})}),define("databaseEditor/components/itemActionMenu.rt",["react/addons","lodash","baseUI","experiment!appBuilderFeaturesRevival"],function(a,b,c,d){"use strict";function e(a){a.stopPropagation()}return function(){return a.createElement("div",{className:"item-action-menu",onClick:e.bind(this)},a.createElement("div",{className:"action-buttons-container"},a.createElement(c.button,{className:"duplicate-item-button",label:"list_dbe_hover_item_duplicate_tooltip",icon:"duplicate",onClick:this.duplicateItem}),a.createElement(c.button,{className:"delete-item-button",label:"list_dbe_hover_item_delete_tooltip",icon:"delete",onClick:this.deleteItem}),d&&this.props.isHidden?a.createElement(c.button,{key:"hoverItemShowBtn",className:"show-item-button",label:"list_dbe_hover_item_show",icon:"quickActionsShow",onClick:this.showItem}):null,d&&!this.props.isHidden?a.createElement(c.button,{key:"hoverItemHideBtn",className:"hide-item-button",label:"list_dbe_hover_item_hide",icon:"quickActionsHide",onClick:this.hideItem}):null,a.createElement(c.button,{className:"edit-item-button",label:"list_dbe_hover_item_edit",icon:"pencil",onClick:this.editItem})))}}),define("databaseEditor/components/itemActionMenu",["react","util","databaseEditor/components/itemActionMenu.rt","databaseEditor/mixins/dbEditorApiContextMixin"],function(a,b,c,d){"use strict";return a.createClass({displayName:"itemActionMenu",mixins:[b.translationMixin,d],propTypes:{item:a.PropTypes.object.isRequired,isHidden:a.PropTypes.bool.isRequired},editItem:function(){var a=this.props.item._iid,b=this.getDbEditorApi();b.setCurrentItem(a,"hover_item")},duplicateItem:function(){this.getDbEditorApi().duplicateItems([this.props.item],"hover_item")},deleteItem:function(){this.getDbEditorApi().deleteItems([this.props.item],"hover_item")},showItem:function(){this.getDbEditorApi().showItems([this.props.item],"hover_item")},hideItem:function(){this.getDbEditorApi().hideItems([this.props.item],"hover_item")},render:c})}),define("databaseEditor/components/itemListRow.rt",["react/addons","lodash","baseUI","databaseEditor/components/itemDetails","databaseEditor/components/itemActionMenu"],function(a,b,c,d,e){"use strict";function f(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement("div",f({className:"item-list-row"},this.filteredProps()),this.props.isOpened?null:a.createElement("span",{className:"drag-handle-container",key:"drag-handle",onMouseDown:this.props.onStartDrag},a.createElement(c.symbol,{name:"dragHandle",className:"symbol-dragHandle"})),this.props.isOpened?null:a.createElement(c.toggle,{name:"checkbox",labelAfterSymbol:!0,key:"item-checkbox",className:"item-selection",value:this.props.isSelected,onChange:this.props.onSelect}),a.createElement(d,{className:b.keys(b.pick({draggable:!0},b.identity)).join(" "),item:this.props.item,showImage:!this.props.isOpened,visibleFields:this.props.visibleFields,isHidden:this.props.isHidden}),a.createElement(e,{item:this.props.item,isHidden:this.props.isHidden}))}}),define("databaseEditor/components/itemListRow",["react","lodash","databaseEditor/components/itemListRow.rt","util"],function(a,b,c,d){"use strict";return a.createClass({displayName:"itemListRow",mixins:[d.propTypesFilterMixin],propTypes:{item:a.PropTypes.object.isRequired,isOpened:a.PropTypes.bool.isRequired,isSelected:a.PropTypes.bool.isRequired,visibleFields:a.PropTypes.arrayOf(a.PropTypes.string),onSelect:a.PropTypes.func.isRequired,onStartDrag:a.PropTypes.func},render:c})}),define("databaseEditor/components/noItems.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:"no-items"},a.createElement(c.symbol,{name:"createYourFirstItem",className:"no-items-image"}),a.createElement("span",{className:"no-items-title"},this.translateIfNeeded("list_dbe_this_list_is_empty")),a.createElement("div",{className:"no-items-click-container"},a.createElement("span",{},this.translateIfNeeded("list_dbe_empty_sate_line2"))))}}),define("databaseEditor/components/noItems",["react","lodash","databaseEditor/components/noItems.rt","databaseEditor/mixins/dbEditorApiContextMixin","util"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"noItems",mixins:[d,e.translationMixin],render:c})}),define("databaseEditor/components/itemListFilter/itemListFilter.rt",["react/addons","lodash","baseUI","symbols"],function(a,b,c,d){"use strict";return function(){return a.createElement("span",{className:b.keys(b.pick({"item-list-filter":!0,"is-open":this.state.isBubbleOpen},b.identity)).join(" ")},a.createElement("span",{},this.translateIfNeeded("list_dbe_items_filter_label")," "),a.createElement("span",{className:"item-list-filter-value-label",ref:"handler",onClick:this.toggleBubble},"\n        ",this.getValueLabel(),"\n        ",a.createElement(d.symbol,{name:"arrowDown"})),this.state.isBubbleOpen?a.createElement(c.bubble,{key:"itemFilterBubble",value:this.getBubbleContent(),closeTriggers:[c.uiConstants.TOOLTIP.TRIGGERS.CLICK,c.uiConstants.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:c.uiConstants.TOOLTIP.ALIGNMENT.BOTTOM,styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.closeBubble,targetNode:this.refs.handler.getDOMNode()}):null)}}),define("databaseEditor/components/itemListFilter/itemListFilterBubble.rt",["react/addons","lodash","symbols"],function(a,b,c){"use strict";function d(a,b){this.props.onChange(a.value)}function e(e,f){return a.createElement("div",{key:e.value,onClick:d.bind(this,e,f),className:b.keys(b.pick({"item-list-filter-bubble-option":!0,selected:this.props.value===e.value},b.identity)).join(" ")},a.createElement(c.symbol,{name:"check"}),a.createElement("span",{},this.translateIfNeeded(e.label)))}return function(){return a.createElement.apply(this,["div",{className:"item-list-filter-bubble"},b.map(this.props.options,e.bind(this))])}}),define("databaseEditor/components/itemListFilter/itemListFilterBubble",["react","lodash","util","databaseEditor/components/itemListFilter/itemListFilterBubble.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"itemListFilterBubble",mixins:[c.translationMixin],propTypes:{value:a.PropTypes.any.isRequired,onChange:a.PropTypes.func.isRequired,options:a.PropTypes.arrayOf(a.PropTypes.shape({label:a.PropTypes.string.isRequired,value:a.PropTypes.any.isRequired})).isRequired},render:d})}),define("databaseEditor/components/itemListFilter/itemListFilter",["react","lodash","util","databaseEditor/components/itemListFilter/itemListFilter.rt","databaseEditor/components/itemListFilter/itemListFilterBubble"],function(a,b,c,d,e){"use strict";function g(a){this.props.onChange(a),this.closeBubble()}var f={all:"list_dbe_items_filter_all",visible:"list_dbe_items_filter_visible",hidden:"list_dbe_items_filter_hidden"};return a.createClass({displayName:"itemListFilter",mixins:[c.translationMixin],propTypes:{value:a.PropTypes.oneOf(["all","visible","hidden"]).isRequired,onChange:a.PropTypes.func.isRequired},getInitialState:function(){return{isBubbleOpen:!1}},getValueLabel:function(){return this.translateIfNeeded(f[this.props.value])},toggleBubble:function(){this.setState({isBubbleOpen:!this.state.isBubbleOpen})},closeBubble:function(){this.setState({isBubbleOpen:!1})},getBubbleContent:function(){return a.createElement(e,{value:this.props.value,onChange:g.bind(this),options:b.map(f,function(a,b){return{label:a,value:b}})})},render:d})}),define("databaseEditor/components/itemsList.rt",["react/addons","lodash","baseUI","uiAnimations","databaseEditor/components/itemListRow","databaseEditor/components/noItems","databaseEditor/components/itemListFilter/itemListFilter","experiment!appBuilderFeaturesRevival"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function j(a,b){this.toggleAllItems()}function k(a,b,c,d){this.toggleItem(c._iid)}function l(a,b,c,d,e){!this.props.openedItemId&&this.refs.sortList.startDrag(d,e)}function m(c,d,f,g){return a.createElement(e,{key:f._iid,item:f,className:b.keys(b.pick({"hidden-item":!1,selected:this.isSelected(f._iid),"no-hover":d>0,"is-open":this.props.openedItemId===f._iid},b.identity)).join(" "),isHidden:!1,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(f._iid),visibleFields:this.props.visibleFields,onSelect:k.bind(this,c,d,f,g),onStartDrag:l.bind(this,c,d,f,g)})}function n(a,b,c,d){this.toggleItem(c._iid)}function o(c,d,f,g){return a.createElement(e,{key:f._iid,item:f,className:b.keys(b.pick({"hidden-item":!0,selected:this.isSelected(f._iid),"no-hover":d>0,"is-open":this.props.openedItemId===f._iid},b.identity)).join(" "),isHidden:!0,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(f._iid),visibleFields:this.props.visibleFields,onSelect:n.bind(this,c,d,f,g)})}function p(){var e=c.sortByDragList,k=this.getSelectedIds().length;return a.createElement("div",i({className:"items-list "+(this.props.openedItemId?"small":"")},this.filteredProps()),a.createElement("header",{className:"list-header"},a.createElement("span",{className:"list-header-left-pane"},a.createElement("span",{className:"list-title"},this.props.listName),h&&!this.props.openedItemId?a.createElement(g,{key:"itemListFilter",value:this.state.itemsFilter,onChange:this.setItemsFilter}):null),a.createElement(c.button,{className:"add-item-btn",label:"list_dbe_edit_item_add_item",onClick:this.addItem})),a.createElement("div",{className:this.props.openedItemId?"add-item-container":"select-all-container"},a.createElement("span",{className:"select-all-checkbox"},a.createElement(c.toggle,{name:"checkbox",labelAfterSymbol:!0,value:k>0,indeterminate:k>0&&k<this.filteredItems().length,className:"item-selection",label:this.getItemsSelectionLabel(k),shouldTranslate:!1,onChange:j.bind(this,e,k)})),this.props.openedItemId?a.createElement(c.button,{key:"list-view-add-btn",label:"list_dbe_edit_item_add_item",className:"small-add-item",onClick:this.addItem}):null,this.getSelectedIds().length>0?a.createElement("span",{key:"multi-select-actions",className:"multi-select-action-menu checked"},a.createElement(c.button,{className:"multi-duplicate",label:"list_dbe_duplicate_Items",icon:"duplicate",onClick:this.duplicateSelectedItems}),a.createElement(c.button,{className:"multi-delete",label:"list_dbe_delete_items",icon:"delete",onClick:this.deleteSelectedItems}),h?a.createElement(c.button,{key:"appBuilderFeaturesRevival-showHide",className:"multi-show-hide",label:"list_dbe_show_hide_multiple_items",icon:"quickActionsShow",onClick:this.showHideSelectedItems}):null):null),0!==this.allItems().length||this.props.loading?null:a.createElement(f,{key:"no-items"}),a.createElement(c.customScroll,{heightRelativetoParent:"calc(100% - 120px)"},a.createElement("div",{className:this.props.openedItemId?"items-container-edit":"items-container"},this.shouldShowVisibleItems()?a.createElement.apply(this,[e,{ref:"sortList",key:"da-list",className:b.keys(b.pick({"sort-list":!this.props.openedItemId,"item-edit-sort-list":this.props.openedItemId,"visible-items-container":!0},b.identity)).join(" "),onItemMoved:this.getDbEditorApi().moveItem,childrenTransition:d.contentAddRemove},b.map(this.props.items,m.bind(this,e,k))]):null,this.shouldShowHiddenItems()?a.createElement.apply(this,["span",{className:"hidden-items-container",key:"hidden-items-container"},b.map(this.props.hiddenItems,o.bind(this,e,k))]):null)))}return function(){return p.apply(this,[])}}),define("databaseEditor/components/itemsList",["react","lodash","util","databaseEditor/components/itemsList.rt","databaseEditor/mixins/dbEditorApiContextMixin","experiment!appBuilderFeaturesRevival"],function(a,b,c,d,e,f){"use strict";function g(a){var c=this.getSelectedIds();return b.filter(a,function(a){return b.includes(c,a._iid)})}return a.createClass({displayName:"itemsList",mixins:[e,c.selectionMixin,c.propTypesFilterMixin],propTypes:{items:a.PropTypes.array.isRequired,hiddenItems:a.PropTypes.array.isRequired,openedItemId:a.PropTypes.string,listName:a.PropTypes.string.isRequired,listId:a.PropTypes.string.isRequired,visibleFields:a.PropTypes.arrayOf(a.PropTypes.string)},getDefaultProps:function(){return{openedItemId:void 0}},getInitialState:function(){return{itemsFilter:"all"}},duplicateSelectedItems:function(){this.getDbEditorApi().duplicateItems(g.call(this,this.filteredItems()),"multiple_selection"),this.clearSelection()},deleteSelectedItems:function(){this.getDbEditorApi().deleteItems(g.call(this,this.filteredItems()),"multiple_selection",this.clearSelection)},showHideSelectedItems:function(){var a=g.call(this,this.props.items),b=g.call(this,this.props.hiddenItems),c=b.length>0?"showItems":"hideItems";this.getDbEditorApi()[c](a.concat(b),"multiple_selection")},addItem:function(){var a=this.props.openedItemId?"item_view":"list_view";this.getDbEditorApi().addItem(a,function(a){this.getDbEditorApi().setCurrentItem(a)}.bind(this)),this.clearSelection(),b.includes(["all","visible"],this.state.itemsFilter)||this.setState({itemsFilter:"all"})},setCurrentItem:function(a){var b=this.getDbEditorApi(),c=this.props.openedItemId?"item_view":"list_view";b.setCurrentItem(a,c)},toggleItem:function(a){var b=this.isSelected(a);this.toggle(a),this.getDbEditorApi().bi.itemSelectionToggle(this.props.listId,a,!b)},toggleAllItems:function(){var a=b.pluck(this.filteredItems(),"_iid"),c=!b.isEmpty(this.getSelectedIds());this.toggleAll(a),this.getDbEditorApi().bi.allItemsSelectionToggle(this.props.listId,!c)},getItemsSelectionLabel:function(a){switch(a){case 0:return c.translate("list_dbe_select_all_label");case 1:return c.translate("list_dbe_1_items_selected");default:return c.translate("list_dbe_x_items_selected").replace("<X>",a)}},allItems:function(){return f?this.props.items.concat(this.props.hiddenItems):this.props.items},setItemsFilter:function(a){this.setState({itemsFilter:a}),this.clearSelection()},filteredItems:function(){if(f)switch(this.state.itemsFilter){case"all":return this.allItems();case"visible":return this.props.items;case"hidden":return this.props.hiddenItems}return this.props.items},shouldShowVisibleItems:function(){return this.props.items.length&&b.includes(["all","visible"],this.state.itemsFilter)},shouldShowHiddenItems:function(){return f&&this.props.hiddenItems.length&&b.includes(["all","hidden"],this.state.itemsFilter)},render:d})}),define("databaseEditor/components/itemEdit.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function e(a){this.getDbEditorApi().setCurrentItem(null)}function f(a){this.getDbEditorApi().deleteItems([a],"edit_item")}function g(a){this.getDbEditorApi().duplicateItems([a],"edit_item")}function h(b,c,d){return a.createElement("div",{className:"item-field",key:c.definition.name},a.createElement(c.component,{item:b,fieldDef:c.definition,placeholder:c.placeholder}))}function i(){var i=this.props.item;return a.createElement("div",d({className:"item-edit",key:this.props.item._iid},this.filteredProps()),a.createElement("div",{className:"no-scroll-container"},a.createElement("header",{className:"item-header"},a.createElement("div",{className:"button-container"},a.createElement(c.button,{className:"close-item-btn",icon:"arrowRight",label:"list_dbe_edit_item_close_item",onClick:e.bind(this,i)})),a.createElement("span",{className:"action-container"},this.state.saveLabel?a.createElement("div",{className:"save-item-label",key:"save-item-label"},this.translateIfNeeded(this.state.saveLabel)):null,a.createElement(c.tooltip,{value:"list_dbe_hover_item_delete_tooltip"},a.createElement(c.button,{className:"delete-item-btn",icon:"delete",onClick:f.bind(this,i)})),a.createElement(c.tooltip,{value:"list_dbe_hover_item_duplicate_tooltip"},a.createElement(c.button,{className:"duplicate-item-btn",icon:"duplicate",onClick:g.bind(this,i)}))))),a.createElement(c.customScroll,{heightRelativetoParent:"calc(100% - 67px)"},a.createElement.apply(this,["div",{className:"item-fields-container"},b.map(this.getFields(),h.bind(this,i)),a.createElement("div",{className:"unused-fields-text"},this.translateIfNeeded("list_dbe_edit_hiding_unused_fields"))])))}return function(){return i.apply(this,[])}}),define("databaseEditor/components/linkTo/linkToField.rt",["react/addons","lodash","panels","util"],function(a,b,c,d){"use strict";function e(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement(c.commonControls.linkTo,e({className:d.inheritClassName("input-link-to-field"),value:this.getLinkData(),onChange:this.setLinkData,showButton:!1,showIcon:!0},this.filterProps()))}}),define("databaseEditor/components/linkTo/linkToFieldButton.rt",["react/addons","lodash","panels"],function(a,b,c){"use strict";return function(){return a.createElement(c.commonControls.linkToButton,b.assign({},{value:this.getLinkData(),onChange:this.setLinkData},this.filterProps()))}}),define("databaseEditor/components/linkTo/linkToField",["react","lodash","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/linkTo/linkToField.rt","databaseEditor/components/linkTo/linkToFieldButton.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"linkToField",mixins:[c],propTypes:{item:a.PropTypes.object.isRequired,fieldDef:a.PropTypes.object.isRequired,useLinkButton:a.PropTypes.bool,label:a.PropTypes.string,placeholder:a.PropTypes.string,minCharsForTooltip:a.PropTypes.number,showButton:a.PropTypes.bool,buttonEditLabel:a.PropTypes.string,buttonAddLabel:a.PropTypes.string},getDefaultProps:function(){return{useLinkButton:!1}},getLinkData:function(){return this.props.item.links&&this.props.item.links[this.props.fieldDef.name]},setLinkData:function(a){var b={};b[this.props.fieldDef.name]=a,this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,{links:b})},filterProps:function(){return b.omit(this.props,["pages","anchors","value","onChange","valueLink"])},render:function(){var a=this.props.useLinkButton?e:d;return a.call(this)}})}),define("databaseEditor/components/itemFields/textItemField.rt",["react/addons","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(a,b,c,d){"use strict";function e(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement("div",{className:"text-item-field"},a.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),a.createElement("div",{className:"text-input"},a.createElement(c.textInput,{valueLink:this.linkedFieldValue(),maxLength:500,placeholder:this.props.placeholder}),this.hasLink()?null:a.createElement(d,b.assign({},{key:"noLink",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?a.createElement(d,e({className:"input-link-to",key:"hasLink",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps())):null)}}),define("databaseEditor/mixins/itemFieldMixin",["lodash","react","databaseEditor/mixins/dbEditorApiContextMixin"],function(a,b,c){"use strict";function d(a,b){return(b||[]).reduce(function(a,b){return a&&a[b]},a)}function e(a){return a.reduceRight(function(a,b){var c={};return c[b]=a,c})}return{propTypes:{item:b.PropTypes.object.isRequired,fieldDef:b.PropTypes.object.isRequired},mixins:[c],getFieldDisplayName:function(){return this.props.fieldDef.displayName||this.props.fieldDef.name},getFieldValue:function(a,b){var c=b||this.props,e=c.item[c.fieldDef.name];return a&&(e=d(e,a)),e},updateFieldValue:function(a,b){var c=[this.props.fieldDef.name].concat(b||[]).concat(a),d=e(c);this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,d)},linkedFieldValue:function(a){var b=this;return{value:this.getFieldValue(a),requestChange:function(c){b.updateFieldValue(c,a)}}},hasLink:function(){return this.props.item.links&&!!this.props.item.links[this.props.fieldDef.name]},getLinkToFieldProps:function(){return a.pick(this.props,["item","fieldDef"])}}}),define("databaseEditor/components/itemFields/textItemField",["react","lodash","databaseEditor/components/itemFields/textItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(a,b,c,d){"use strict";return a.createClass({displayName:"textItemField",mixins:[d],render:c})}),define("databaseEditor/components/itemFields/buttonItemField.rt",["react/addons","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(a,b,c,d){"use strict";return function(){return a.createElement("div",{className:"text-item-field"},a.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),a.createElement("div",{className:"text-input"},a.createElement(c.textInput,{valueLink:this.linkedFieldValue(),placeholder:"list_dbe_button_placeholder",maxLength:100})),a.createElement(d,b.assign({},{label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps()),'\r\n            showIcon="',!0,'"\r\n    '))}}),define("databaseEditor/components/itemFields/buttonItemField",["react","lodash","databaseEditor/components/itemFields/buttonItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(a,b,c,d){"use strict";return a.createClass({displayName:"buttonItemField",mixins:[d],render:c})}),define("databaseEditor/components/itemFields/dateItemField.rt",["react/addons","lodash","baseUI","symbols","util","uiAnimations","databaseEditor/components/linkTo/linkToField"],function(a,b,c,d,e,f,g){"use strict";function h(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function i(){var i=this.getValueAsDate();return a.createElement("div",{className:"date-item-field"},a.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),a.createElement("div",{className:"text-input"},a.createElement("div",{className:b.keys(b.pick({"control-text-input":!0,"date-picker-open":this.state.dateBubbleOpen},b.identity)).join(" "),onClick:this.toggleDateBubble},a.createElement(d.symbol,{name:"calendar"}),a.createElement("span",{ref:"dateSpan",className:b.keys(b.pick({disabled:b.isEmpty(this.getFieldValue().iso)},b.identity)).join(" ")},i?i.toLocaleDateString():e.translate("list_dbe_date_empty"))),this.hasLink()?null:a.createElement(g,b.assign({},{key:"add-link-button",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?a.createElement(g,h({className:"input-link-to",key:"link-to-field",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps())):null,a.createElement(f.tooltipAnimation,{},this.state.dateBubbleOpen?a.createElement(c.bubble,{key:"dateBubble",value:this.getDatePicker(i),width:"301px",closeTriggers:[c.uiConstants.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:c.uiConstants.TOOLTIP.ALIGNMENT.BOTTOM,styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.hideDateBubble,targetNode:this.refs.dateSpan.getDOMNode(),ref:"popup",style:{position:"absolute"}}):null))}return function(){return i.apply(this,[])}}),define("databaseEditor/components/itemFields/dateItemField",["react","lodash","baseUI","databaseEditor/mixins/itemFieldMixin","databaseEditor/components/itemFields/dateItemField.rt"],function(a,b,c,d,e){"use strict";var f=["January","February","March","April","May","June","July","August","September","October","November","December"],g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return a.createClass({displayName:"dateItemField",mixins:[d],getInitialState:function(){return{dateBubbleOpen:!1}},getDatePicker:function(d){var e={value:d,onChange:this.updateDate,todayLabel:"list_DatePicker_TodayButton_Label",goToSelectedLabel:"list_DatePicker_GoToSelectedButton_Label",monthNames:b.map(f,function(a){return"list_DatePicker_MonthsConstLong_"+a}),days:b.map(g,function(a){return"list_DatePicker_DayConstShort_"+a}),startDay:"list_DatePicker_DayConstShort_Sunday",popOnlyValue:!0,showDelete:!0};return a.createElement(c.datePicker,e)},getValueAsDate:function(){var a=this.getFieldValue();return a&&a.iso?new Date(a.iso):null},updateDate:function(a){this.updateFieldValue(a?a.toISOString():"","iso"),this.toggleDateBubble()},toggleDateBubble:function(){this.setState({dateBubbleOpen:!this.state.dateBubbleOpen})},hideDateBubble:function(){this.setState({dateBubbleOpen:!1})},render:e})}),define("databaseEditor/components/itemFields/imageItemField.rt",["react/addons","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(a,b,c,d){"use strict";function e(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function f(){var f=this.getFieldValue();return a.createElement("div",{},a.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),a.createElement("div",{className:"image-item-field"},a.createElement(c.imageChangeRemove,{className:"image-panel",addButtonLabel:"list_dbe_edit_item_image_add_image",changeButtonLabel:"list_dbe_edit_item_change_image",removeButtonLabel:"list_dbe_edit_item_remove_image",onChange:this.onMediaRemoved,mediaManager:this.getDbEditorApi().mediaServices.mediaManager,value:this.getWPhotoData(f)}),a.createElement("div",{className:"text-panel"},a.createElement(c.textInput,{label:"list_dbe_edit_item_alt",placeholder:"list_dbe_edit_item_alt_placeholder",value:f.title,onChange:this.updateTitle,maxLength:100,disabled:b.isEmpty(f.src)}),a.createElement(d,e({className:"input-link-to",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder",disabled:b.isEmpty(f.src),showIcon:!0},this.getLinkToFieldProps())))))}return function(){return f.apply(this,[])}}),define("databaseEditor/components/itemFields/imageItemField",["react","lodash","databaseEditor/components/itemFields/imageItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(a,b,c,d){"use strict";return a.createClass({displayName:"imageItemField",mixins:[d],updateTitle:function(a){this.updateFieldValue(a,["title"])},getWPhotoData:function(a){return b.assign({type:"Image",uri:a.src},b.pick(a,["title","width","height"]))},onMediaRemoved:function(a){var c={src:"",title:"",height:0,width:0};a&&b.assign(c,{src:a.uri,title:a.title,height:a.height,width:a.width}),this.updateFieldValue(c)},render:c})}),define("databaseEditor/components/itemFields/richTextItemField.rt",["react/addons","lodash","textControls"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement("div",{className:b.keys(b.pick({"rich-text-item-field":!0,editing:this.state.editing},b.identity)).join(" ")},a.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),a.createElement(c.richTextInput,d({ref:"richTextInput",className:"rich-text-input",onFocus:this.onFocus,onBlur:this.onBlur,hideToolbar:!this.state.editing,isFocusOnInit:!1,isFixedHeight:!0,openLinkDialog:this.openLinkDialog,openColorPicker:this.openColorPicker,value:this.getValue(),onChange:this.updateValue,panelManager:this.getPanelManager()},this.getRichTextProps())))}}),define("databaseEditor/migrations/richTextMigrations",["lodash"],function(a){"use strict";function e(a){return a=a.replace(c,""),a=a.replace(d,"")}function f(c){return a.get(c,"version",0)>=b?c:(c.text=e(c.text),c.version=b,c)}function g(){return b}var b=3,c=/<hatul[^>]*>/gi,d=/<\/hatul>/gi;return{migrateToCurrentVersion:f,getCurrentVersion:g}}),define("databaseEditor/components/itemFields/richTextItemField",["react","lodash","util","databaseEditor/components/itemFields/richTextItemField.rt","databaseEditor/mixins/itemFieldMixin","textControls","databaseEditor/migrations/richTextMigrations","experiment"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){var b;"function"==typeof MouseEvent?b=new window.MouseEvent("mousedown",{bubbles:!0,button:0}):(b=document.createEvent("MouseEvents"),b.initMouseEvent("mousedown",!0,!0,a,0,0,0,0,0,!1,!1,!1,!1,0,null)),a.dispatchEvent(b)}return a.createClass({displayName:"richTextItemField",mixins:[e],getInitialState:function(){return{editing:!1}},getRichTextProps:function(){var a=this.getDbEditorApi().getSiteInfo(),c=a.generalInfo.getDocumentType(),d=a.theme.fonts.getCharacterSet(),e={themeColors:a.theme.colors.getAll(),themeFonts:a.theme.fonts.getAll(),documentType:c,languages:d,fonts:f.fontUtils.getCurrentSelectableFontsWithParams(a)};return h.isOpen("se_fontsRefactor")&&b.merge(e,{fontsUrls:a.fonts.css.getUrls(),themeFontsCss:a.theme.fonts.getThemeStyles(),themeColorsCss:a.theme.colors.getCss()}),e},getValue:function(){var a=this.getFieldValue();return"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(a=g.migrateToCurrentVersion(a)),{text:a.text,linkList:a.links}},updateValue:function(a){
var b={text:a.text,links:a.linkList};"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(b.version=g.getCurrentVersion()),this.updateFieldValue(b)},getPanelManager:function(){return this.getDbEditorApi().panelManager},openLinkDialog:function(a,b){var d=this.getDbEditorApi(),e=c.link.getLinkPanelProps(d.documentServices,{link:a,callback:b});d.panelManager.openPanel("panels.toolPanels.linkPanel",e)},openColorPicker:function(a,b,c,d){var e=this.getDbEditorApi(),f=e.getSiteInfo();e.panelManager.openPanel("panels.toolPanels.colorPicker.colorPickerPanel",{siteCustomColors:f.theme.colors.getCustomUsedInSkins(),sessionStorage:e.getUserPreferences().session,value:a,onChange:b,isBlockingLayerFullScreen:!0,shouldBlockOuterScroll:!0,top:c.top,left:c.left,previewOnHover:d},!0)},onFocus:function(){i(this.getDOMNode()),this.refs.richTextInput.showScroll(),this.setState({editing:!0})},onBlur:function(){this.refs.richTextInput.hideScroll(),this.setState({editing:!1})},render:d})}),define("databaseEditor/components/itemFields/videoItemField.rt",["react/addons","lodash","baseUI","util"],function(a,b,c,d){"use strict";function e(){var b=this.state.status;return a.createElement("div",{className:"inputs-container "+b},a.createElement(c.videoInput,{valueLink:this.linkedFieldValue(),nonEmptyButtonLabel:"list_dbe_edit_item_search_video",emptyButtonLabel:"list_dbe_edit_item_search_video",panelManager:this.getDbEditorApi().panelManager}),a.createElement("div",{},a.createElement(c.textInput,{ref:"textInput",className:"video-url-input",label:"list_dbe_edit_item_video_url",value:this.state.videoUrl,onChange:this.updateVideoUrl,placeholder:this.props.placeholder}),a.createElement("div",{className:"error-msg-and-button"},a.createElement("span",{},"invalid"===b?d.translate("list_dbe_edit_item_bad_video_url"):""),this.state.videoUrl!==this.getVideoUrl()&&"idle"===b?a.createElement(c.button,{key:"update-button",className:"update-button",label:"list_dbe_edit_item_update_video_url",onClick:this.handleClick}):null,"idle"!==b?a.createElement(c.symbol,{key:"validation-status",name:"valid"===b?"inputValidationSuccess":"inputValidationError"}):null)))}return function(){return a.createElement("div",{className:"video-item-field"},a.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.apply(this,[]))}}),define("databaseEditor/components/itemFields/videoItemField",["react","lodash","util","baseUI","databaseEditor/components/itemFields/videoItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(a,b,c,d,e,f){"use strict";function g(){this.success=!0;var a={status:"valid"};if(this.setState(a),b.isEmpty(this.state.videoUrl))this.updateFieldValue({videoId:""});else{var d=c.videoUtils.getVideoDataFromUrl(this.state.videoUrl);this.updateFieldValue({videoType:d.videoType,videoId:d.videoId})}b.delay(function(){this.success=!1,this.setState({status:"idle"})}.bind(this),2e3)}function h(){this.setState({status:"invalid"}),this.refs.textInput.focus()}return a.createClass({displayName:"videoItemField",mixins:[f],getInitialState:function(){return{status:"idle",videoUrl:this.getVideoUrl()}},componentWillReceiveProps:function(a){var c=this.getVideoUrl(a);b.isEqual(this.getVideoUrl(),c)||this.updateVideoUrl(c)},getVideoUrl:function(a){return c.videoUtils.getVideoUrl(this.getFieldValue(null,a))},updateVideoUrl:function(a){this.setState({status:this.success?this.state.status:"idle",videoUrl:a})},handleClick:function(){b.isEmpty(this.state.videoUrl)?b.defer(g.bind(this)):c.videoUtils.verifyVideoUrl(this.state.videoUrl,g.bind(this),h.bind(this))},render:e})}),define("databaseEditor/components/itemEdit",["react","lodash","util","databaseEditor/components/itemEdit.rt","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/itemFields/textItemField","databaseEditor/components/itemFields/buttonItemField","databaseEditor/components/itemFields/dateItemField","databaseEditor/components/itemFields/imageItemField","databaseEditor/components/itemFields/richTextItemField","databaseEditor/components/itemFields/videoItemField"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function o(a){var c=a.metadata&&a.metadata.showAsHint,d=b.compact([a.type,c]).join("|");return l[d.toLowerCase()]}function p(a){return m[a]}function q(a){if(a.item._iid!==this.props.item._iid)this.setState({saveLabel:null});else{var c=a.saveState!==this.props.saveState;c=c&&!("Idle"===a.saveState&&b.includes(["Saved","Failed","Error"],this.props.saveState)),c&&this.setState({saveLabel:p(a.saveState)})}}var l={string:f,"string|asprice":f,"string|asbutton":g,"wix:image":i,"wix:richtext":j,"wix:video":k,"wix:date":h},m={Error:"list_dbe_edit_item_status_error",Saving:"list_dbe_edit_item_status_saving",Saved:"list_dbe_edit_item_status_saved",Idle:"list_dbe_edit_item_status_idle",Failed:"list_dbe_edit_item_status_error"},n={Title:"list_dbe_title_placeholder",Subtitle:"list_dbe_subtitle_placeholder",Description:"list_dbe_description_placeholder",Price:"list_dbe_price_placeholder",Video:"list_dbe_edit_item_video_link_placeholder"};return a.createClass({displayName:"itemEdit",mixins:[e,c.propTypesFilterMixin,c.blockOuterScrollMixin,c.translationMixin],propTypes:{item:a.PropTypes.object.isRequired,itemSchema:a.PropTypes.object.isRequired,saveState:a.PropTypes.string.isRequired,visibleFields:a.PropTypes.arrayOf(a.PropTypes.string)},getInitialState:function(){return{saveLabel:null}},componentWillReceiveProps:function(a){q.call(this,a)},getFields:function(){var a=this;return b(a.props.itemSchema.fields).filter(function(c){return b.includes(a.props.visibleFields,c.name)||"title"===c.name}).map(function(a){return{component:o(a),definition:a,placeholder:n[a.displayName]||""}}).filter("component").value()},render:d})}),define("databaseEditor/dbEditor/dbEditor.rt",["react/addons","lodash","databaseEditor/components/itemsList","databaseEditor/components/itemEdit","uiAnimations"],function(a,b,c,d,e){"use strict";function f(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement("div",f({className:"db-editor-container",onMouseDown:this.blockMiddleMouseClick},this.getAnimationsEventListeners()),a.createElement(c,{items:this.props.items,hiddenItems:this.props.hiddenItems,openedItemId:this.props.currentItemId,listName:this.props.listName,listId:this.props.currentListId,visibleFields:this.props.visibleFields}),a.createElement(e.dbEditItemSlide,{direction:"right"},this.props.currentItemId?a.createElement(d,{key:"item-edit",item:this.getItem(this.props.currentItemId),itemSchema:this.props.itemSchema,visibleFields:this.props.visibleFields,saveState:this.props.saveState}):null))}}),define("databaseEditor/dbEditor/dbEditor",["react","lodash","uiAnimations","databaseEditor/dbEditor/dbEditor.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"dbEditor",mixins:[c.animationManager],propTypes:{dbEditorApi:a.PropTypes.object.isRequired,currentListId:a.PropTypes.string,items:a.PropTypes.array,hiddenItems:a.PropTypes.array,currentItemId:a.PropTypes.string,listName:a.PropTypes.string,itemSchema:a.PropTypes.object,saveState:a.PropTypes.string,visibleFields:a.PropTypes.arrayOf(a.PropTypes.string)},childContextTypes:{dbEditorApi:a.PropTypes.object.isRequired,mediaServices:a.PropTypes.object},getDefaultProps:function(){return{items:[]}},componentDidMount:function(){this.props.dbEditorApi.bi.dbEditorOpenSuccess(this.props.currentListId)},getChildContext:function(){return{dbEditorApi:this.props.dbEditorApi,mediaServices:this.props.dbEditorApi.mediaServices}},getItem:function(a){return b.find(this.props.items,{_iid:a})||b.find(this.props.hiddenItems,{_iid:a})},blockMiddleMouseClick:function(a){return 1===a.button?!1:void 0},render:d})}),define("databaseEditor/dataService/DataService",["lodash","pLoader!santa:wixappsBuilder"],function(a,b){"use strict";function e(b){a.forEach(this.updateCallbacks,function(a){a(b)})}function f(){return{type:d,instanceId:this.storeId}}function g(a,b){function g(){h.call(this,a,b),e.call(this)}var d=c.getApplicationRepoRequest(a,f.call(this));null!==d&&this.store.loadBatch([d],g.bind(this))}function h(a,b){var d=null,g=c.getAppPartDataRequest(a,f.call(this),b,d);null!==g&&this.store.loadBatch([g],e.bind(this,b))}function i(a,b){this.store=a,this.storeId=b,this.updateCallbacks=[],this.wasRepoRequested=!1,this.requestedLists={}}var c=b.builderDataHandler,d="appbuilder";return i.prototype={loadListData:function(a){if(!this.requestedLists[a]){this.requestedLists[a]=!0;var b=this.store.getData();this.wasRepoRequested?h.call(this,b,a):(this.wasRepoRequested=!0,g.call(this,b,a))}},wasRepoLoaded:function(){return b.dataFetchingStateManager.hasPackageLoadedSuccessfully(this.store.getData(),f.call(this))},wasListLoaded:function(a){return b.dataFetchingStateManager.hasPartLoadedSuccessfully(this.store.getData(),f.call(this),a)},wasRepoLoadErroneous:function(){return b.dataFetchingStateManager.isPackageErroneous(this.store.getData(),f.call(this))},wasListLoadErroneous:function(a){return b.dataFetchingStateManager.isPartErroneous(this.store.getData(),f.call(this),a)},registerForUpdates:function(a){this.updateCallbacks.push(a)}},i}),define("databaseEditor/dbEditor/DbEditorApi",["lodash","mediaServices","util","experiment!appBuilderDataMigration","userPreferences"],function(a,b,c,d){"use strict";function f(a){return"databaseEditor.panels."+a}function g(a){var b=this.dataService.wasRepoLoadErroneous(),c=this.dataService.wasListLoadErroneous(a);b||c?(this.bi.listLoadFailed(a,!b,!c),this.panelManager.openPanel(f("loadFailedMessagePanel"),{onConfirm:function(){window.location.reload()}})):h.call(this)}function h(){var b=n.call(this);a.forEach(this.stateChangedCallbacks,function(a){a(b)})}function i(){return this.appbuilderServices.data.lists.getItems(this.currentListId)}function j(){return this.appbuilderServices.data.lists.getHiddenItems(this.currentListId)}function k(){return this.appbuilderServices.data.lists.getListName(this.currentListId)}function l(){var b=this.appbuilderServices.layout.getAllFields,c=a(this.currentListId).thru(b).reject("hidden").map("name").value(),d=a(b(this.currentListId,"Mobile")).reject("hidden").map("name").value();return a.uniq(c.concat(d))}function m(a,b){b?setTimeout(m.bind(this,a),b):(this.saveState=a,h.call(this))}function n(){var a=this.dataService.wasRepoLoaded(),b=a&&this.dataService.wasListLoaded(this.currentListId);return{currentListId:this.currentListId,items:b?i.call(this):[],hiddenItems:b?j.call(this):[],currentItemId:this.currentItemId,listName:a?k.call(this):null,itemSchema:a?this.appbuilderServices.data.lists.getItemSchema(this.currentListId):null,visibleFields:this.visibleFields,dbEditorApi:this,openPanels:this.panelManager.getOpenPanels(),saveState:this.saveState,loading:!b}}function o(){function a(){return m.call(this,e.saved),this.savePending?(this.savePending=!1,void o.call(this)):void setTimeout(function(){this.saveState!==e.saving&&m.call(this,e.idle)}.bind(this),this.idleTimeout)}function b(){this.savePending=!1,m.call(this,e.failed),m.call(this,e.idle,this.idleTimeout),this.panelManager.openPanel(f("saveFailedMessagePanel"))}return this.disableAutoSave===!0?void h.call(this):this.saveState===e.saving?void(this.savePending=!0):(m.call(this,e.saving),void this.appbuilderServices.save(a.bind(this),b.bind(this)))}function p(a){var b=Object.create(a);return b.openPanel=function(b,d){a.openPanel(b,d,!0)},b}function q(b,c){return a.filter(b,function(b){return a.find(c,{_iid:b._iid})})}function r(b,d){var e=a.assign({},d,{title:c.translate("list_dbe_prefix_for_duplicated_item")+d.title});return this.appbuilderServices.data.items.create(b,e)}function s(c,f,h,i,j,k,m,o,q,r,s){a.bindAll(this),this.disableAutoSave=s,this.idleTimeout=q,this.dataService=c,this.appbuilderServices=h.wixapps.appbuilder,this.documentServices=h,this.siteInfo=i,this.serviceTopology=k,this.stateChangedCallbacks=[],this.currentListId=o,this.currentItemId=null,this.saveState=e.idle,this.savePending=!1,this.panelManager=p(m),this.mediaServices=b,this.userPreferences=j,this.bi=f,d&&this.appbuilderServices.migration.migrateList(o),c.registerForUpdates(g.bind(this)),r&&(this.visibleFields=l.call(this),r(n.call(this)))}var e={idle:"Idle",saved:"Saved",failed:"Failed",saving:"Saving"};return s.prototype={getServiceTopology:function(){return this.serviceTopology},getUserPreferences:function(){return this.userPreferences},setCurrentList:function(a){this.currentListId=a,this.currentItemId=null,this.dataService.loadListData(a),this.visibleFields=l.call(this),h.call(this)},getPagesData:function(){return this.documentServices.pages.getPagesData()},getSiteMenuItems:function(){return this.documentServices.mainMenu.getMenu()},createDefaultDataItem:function(a){return this.documentServices.data.createItem(a)},setCurrentItem:function(a,b){this.currentItemId=a,h.call(this),a&&b&&this.bi.itemEdit(b,this.currentListId,a)},debouncedSave:a.debounce(o,500),broadcastStateChanged:h,moveItem:function(a,b){var c=this.appbuilderServices.data.lists.selection.get(this.currentListId),d=c.itemIds,e=d[a];d.splice(b,0,d.splice(a,1)[0]),this.bi.itemMove(this.currentListId,c.id,e),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,d),o.call(this)},addItem:function(b,c){c=c||a.noop;var d=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),e=this.appbuilderServices.data.items.create(d),f=this.appbuilderServices.data.lists.selection.get(this.currentListId),g=f.itemIds;return g.unshift(e),this.bi.itemAdd(b,this.currentListId,f.id,e),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,g),c(e),o.call(this),e},updateItem:function(a,b,c){this.appbuilderServices.data.items.update(a,b,c),this.debouncedSave(),h.call(this)},duplicateItems:function(b,c){var d=a.pluck(b,"_iid"),e=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),f=this.appbuilderServices.data.lists.selection.get(this.currentListId);this.bi.itemsDuplicate(c,this.currentListId,f.id,d),a.forEach(q(b,j.call(this)),r.bind(this,e),this);var g=a.map(q(b,i.call(this)),r.bind(this,e),this),h=f.itemIds,k=a.findLastIndex(h,function(b){return a.includes(d,b)});h.splice.apply(h,[k+1,0].concat(g)),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,h),this.currentItemId&&this.setCurrentItem(a.last(g)),o.call(this)},deleteItems:function(b,c,d){function g(){var f=e.appbuilderServices.data.lists.selection.get(e.currentListId);e.bi.itemsDelete(c,e.currentListId,f.id,a.pluck(b,"_iid")),a.forEach(b,function(b){if(e.currentItemId===b._iid){var c=a.pluck(i.call(e),"_iid"),d=c.indexOf(b._iid),f=c[d+1]||c[d-1]||null;e.setCurrentItem(f)}e.appbuilderServices.data.items["delete"](b._type,b._iid)}),d(),o.call(e)}var e=this;d=d||a.noop,this.panelManager.openPanel(f("deleteItemsConfirmationPanel"),{onConfirm:g,onCancel:a.noop})},showItems:function(b){var c=this.appbuilderServices.data.lists.selection.get(this.currentListId),d=a.pluck(b,"_iid"),e=a.union(c.itemIds,d);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,e),o.call(this)},hideItems:function(b){var c=this.appbuilderServices.data.lists.selection.get(this.currentListId),d=a.pluck(b,"_iid"),e=a.difference(c.itemIds,d);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,e),o.call(this)},getCurrentListVersion:function(){return this.appbuilderServices.data.lists.getListVersion(this.currentListId)},registerForStateChanged:function(a){this.stateChangedCallbacks.push(a)},getSiteInfo:function(){return this.siteInfo}},s}),define("databaseEditor/panels/deleteItemsConfirmationPanel.rt",["react/addons","lodash","panels","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(c.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"delete-list-items-confirmation",type:"important",panelTitle:this.translateIfNeeded("list_dbe_delete_are_you_sure_title"),onCancel:this.props.onCancel,onConfirm:this.props.onConfirm,confirmLabel:"list_dbe_delete_are_you_sure_confirm_button",cancelLabel:"list_dbe_delete_are_you_sure_cancel_button"},a.createElement(d.symbol,{name:"garbage-truck-clipart",className:"image"}),a.createElement("div",{className:"text"},a.createElement("span",{},this.translateIfNeeded("list_dbe_delete_items_subtitle")),a.createElement("span",{},this.translateIfNeeded("list_dbe_delete_are_you_sure_text"))))}}),define("databaseEditor/panels/deleteItemsConfirmationPanel",["react","util","lodash","databaseEditor/panels/deleteItemsConfirmationPanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"deleteItems",mixins:[b.translationMixin],render:d})}),define("databaseEditor/panels/saveFailedMessagePanel.rt",["react/addons","lodash","panels","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(c.frames.messagePanelFrame,{className:"list-save-failed-panel",editorAPI:this.getEditorAPI(),panelName:this.props.panelName,confirmLabel:"list_dbe_general_error_button",panelTitle:this.translateIfNeeded("list_dbe_general_error_dialog_title")},a.createElement("div",{className:"content-wrapper"},a.createElement(d.symbol,{name:"plaster",className:"error-img"}),a.createElement("div",{className:"msg-text"},a.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_subtitle")),a.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_text")),a.createElement("p",{},a.createElement("br",{})),a.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_text_2")),a.createElement("a",{className:"support-link",href:"https://www.wix.com/support/html5/"},"https://www.wix.com/support/"))))}}),define("databaseEditor/panels/saveFailedMessagePanel",["react","util","lodash","core","databaseEditor/panels/saveFailedMessagePanel.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"saveFailedMessagePanel",mixins:[b.translationMixin,d.mixins.editorAPIMixin],render:e})}),define("databaseEditor/panels/loadFailedMessagePanel.rt",["react/addons","lodash","panels","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(c.frames.confirmationPanelFrame,{panelName:this.props.panelName,panelTitle:this.translateIfNeeded("list_dbe_loading_error_title"),className:"list-load-failed-panel",onConfirm:this.props.onConfirm,onCancel:this.props.onCancel,confirmLabel:"list_dbe_loading_error_button",cancelLabel:"list_dbe_error_loading_close_manage_items"},a.createElement(d.symbol,{name:"plaster",className:"error-img"}),a.createElement("div",{className:"msg-text"},a.createElement("span",{},this.translateIfNeeded("list_dbe_loading_error_subtitle")),a.createElement("span",{},this.translateIfNeeded("list_dbe_loading_error_text")),a.createElement("a",{className:"support-link",href:"https://www.wix.com/support/html5/"},"https://www.wix.com/support/")))}}),define("databaseEditor/panels/loadFailedMessagePanel",["react","util","lodash","databaseEditor/panels/loadFailedMessagePanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"loadFailedMessagePanel",mixins:[b.translationMixin],render:d})}),define("databaseEditor/panels/panels",["databaseEditor/panels/deleteItemsConfirmationPanel","databaseEditor/panels/saveFailedMessagePanel","databaseEditor/panels/loadFailedMessagePanel"],function(a,b,c){"use strict";return{deleteItemsConfirmationPanel:a,saveFailedMessagePanel:b,loadFailedMessagePanel:c}}),define("databaseEditor/bi/events",[],function(){"use strict";var a=59,b="listim2";return{LIST_DB_MANAGER_OPENED:{src:a,endpoint:b,evid:107,fields:{list_part_id:"string"}},LIST_DB_MANAGER_ERROR_LOADING:{src:a,endpoint:b,evid:108,fields:{list_part_id:"string",error_description:"string"}},LIST_DB_MANAGER_REORDER_ITEMS_DROP:{src:a,endpoint:b,evid:109,fields:{item_id:"string",list_part_id:"string",selector_id:"string"}},LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK:{src:a,endpoint:b,evid:110,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_id:"string"}},LIST_DB_MANAGER_SELECT_ITEM_CLICK:{src:a,endpoint:b,evid:113,fields:{list_part_id:"string",item_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_SELECT_ALL_CLICK:{src:a,endpoint:b,evid:114,fields:{list_part_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_DUPLICATE_ITEM:{src:a,endpoint:b,evid:117,fields:{origin:"string",list_part_id:"string",selector_id:"string",source_item_ids:"string"}},LIST_DB_MANAGER_DELETE_ITEMS_CLICK:{src:a,endpoint:b,evid:118,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_ids:"string"}},LIST_DB_MANAGER_EDIT_ITEM_CLICK:{src:a,endpoint:b,evid:119,fields:{origin:"string",list_part_id:"string",item_id:"string"}},LIST_DB_MANAGER_LIST_LOAD_FAIL:{src:a,endpoint:b,evid:121,fields:{list_part_id:"string",repo_loaded:"bool",data_loaded:"bool"}}}}),define("databaseEditor/bi/service",["databaseEditor/bi/events","pLoader!santa:utils"],function(a,b){"use strict";function c(a){this._reportBI=a}return c.prototype={sendEvent:function(a,c){try{this._reportBI(a,c)}catch(d){b.log.info("Error sending BI event",d)}},dbEditorOpenSuccess:function(b){this.sendEvent(a.LIST_DB_MANAGER_OPENED,{list_part_id:b})},dbEditorOpenFailed:function(b,c){this.sendEvent(a.LIST_DB_MANAGER_ERROR_LOADING,{list_part_id:b,error_description:c.toString()})},listLoadFailed:function(b,c,d){this.sendEvent(a.LIST_DB_MANAGER_LIST_LOAD_FAIL,{list_part_id:b,repo_loaded:c?"true":"false",data_loaded:d?"true":"false"})},itemMove:function(b,c,d){this.sendEvent(a.LIST_DB_MANAGER_REORDER_ITEMS_DROP,{item_id:d,list_part_id:b,selector_id:c})},itemAdd:function(b,c,d,e){this.sendEvent(a.LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK,{origin:b,list_part_id:c,selector_id:d,item_id:e})},itemsDuplicate:function(b,c,d,e){this.sendEvent(a.LIST_DB_MANAGER_DUPLICATE_ITEM,{origin:b,list_part_id:c,selector_id:d,source_item_ids:e.join(",")})},itemsDelete:function(b,c,d,e){this.sendEvent(a.LIST_DB_MANAGER_DELETE_ITEMS_CLICK,{origin:b,list_part_id:c,selector_id:d,item_ids:e.join(",")})},itemEdit:function(b,c,d){this.sendEvent(a.LIST_DB_MANAGER_EDIT_ITEM_CLICK,{origin:b,list_part_id:c,item_id:d})},itemSelectionToggle:function(b,c,d){this.sendEvent(a.LIST_DB_MANAGER_SELECT_ITEM_CLICK,{list_part_id:b,item_id:c,state_after_click:!!d})},allItemsSelectionToggle:function(b,c){this.sendEvent(a.LIST_DB_MANAGER_SELECT_ALL_CLICK,{list_part_id:b,state_after_click:!!c})}},c}),define("databaseEditor",["databaseEditor/dbEditor/dbEditor","databaseEditor/dataService/DataService","databaseEditor/dbEditor/DbEditorApi","databaseEditor/panels/panels","databaseEditor/bi/service"],function(a,b,c,d,e){"use strict";return{dbEditor:a,DataService:b,DbEditorApi:c,panels:d,BIService:e}});