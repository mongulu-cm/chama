define("backgroundPresets/components/backgroundPresetSection.rt",["react/addons","lodash","baseUI","util"],function(a,b,c,d){"use strict";function e(a,b){this.selectPreset(a,"presetBackgrounds",b)}function f(b,f){return a.createElement("li",{className:"preset-list-item",key:"preset"+f,onClick:e.bind(this,b,f)},a.createElement(c.tooltip,{value:this.getMediaPreviewComp(b),alignment:"right",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,delay:"300",width:"294px",noArrow:!0},a.createElement("div",{className:"preset-list-preset",style:this.getThumbStyle(b)},this.getMediaType(b)===this.mediaTypes.VIDEO?a.createElement("div",{style:this.getOverlayStyle(b),className:"preset-list-preset-overlay",key:"preset-list-preset-overlay"}):null,this.getMediaType(b)===this.mediaTypes.VIDEO?a.createElement("div",{className:"preset-list-preset-video-controls",key:"bgVideoIndicator"},a.createElement(c.symbol,{name:"bgVideoIndicator"})):null,b.thumbnail&&b.thumbnail.title?a.createElement("div",{key:"preset-title",className:"preset-title"},d.translate(b.thumbnail.title)):null)))}return function(){return a.createElement("div",{className:"bg-preset-list-section section-wrapper"},a.createElement("div",{className:"section-header"},a.createElement("div",{className:"title-line"},a.createElement("div",{className:"title"},this.props.title),a.createElement(c.infoIcon,{key:"infoIcon",className:"info-icon",text:this.props.infoTooltip}))),a.createElement.apply(this,["ul",{className:"preset-list-section-list columns-"+(this.props.columns||1)},b.map(this.getPresetData(),f.bind(this))]))}}),define("backgroundPresets/components/mediaPreview.rt",["react/addons","lodash","util"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function e(){var e=this.getMediaType(),f=c.backgroundPanelUtils;return a.createElement("div",{className:"media-preview-panel"},a.createElement("div",{className:b.keys(b.pick({"media-preview-wrapper":!0,hide:e===this.mediaTypes.VIDEO&&!this.state.isPreviewReady,show:e===this.mediaTypes.VIDEO&&this.state.isPreviewReady},b.identity)).join(" ")},a.createElement("div",d({className:"media-preview-color"},{style:this.getBackgroundColor()})),e===this.mediaTypes.IMAGE?a.createElement("div",d({className:"media-preview-image",key:"media-preview-image"},{style:this.getBackgroundStyle(e)})):null,e===this.mediaTypes.VIDEO?a.createElement("div",d({className:"media-preview-video-wrapper",key:"media-preview-video-wrapper"},{style:this.getVideoStyle()}),a.createElement("video",{autoPlay:!0,loop:!0,muted:!0,preload:"none",ref:"videoInstance",className:"media-preview-video"},a.createElement("source",{src:this.getVideoSource("mp4"),type:"video/mp4"}),a.createElement("source",{src:this.getVideoSource("webm"),type:"video/webm"}))):null,a.createElement("div",{className:"media-preview-overlay",style:f.getOverlayStyle(this.props.data,this.getEditorAPI())})),a.createElement("div",{className:"media-preview-caption"},a.createElement("span",{className:"media-title"},this.getMediaCaption()),e===this.mediaTypes.VIDEO?a.createElement("span",{className:"video-duration",key:"video-duration"},this.getSecInMin()):null))}return function(){return e.apply(this,[])}}),define("backgroundPresets/components/mediaPreview",["react","lodash","util","core","backgroundPresets/components/mediaPreview.rt"],function(a,b,c,d,e){"use strict";function k(a){return b.find(a,{quality:h})}var f=270,g=152,h="480p",i=c.imageTransform,j=c.backgroundPanelUtils;return a.createClass({displayName:"mediaPreview",mediaTypes:j.getMediaTypes(),mixins:[d.mixins.editorAPIMixin],getInitialState:function(){return{isPreviewReady:!1}},componentWillUnmount:function(){this.getMediaType()===this.mediaTypes.VIDEO&&(this.getInstance().removeEventListener("timeupdate",this.onPlaying),this.removeVideoSecurely())},componentDidMount:function(){this.getMediaType()===this.mediaTypes.VIDEO&&this.getInstance().addEventListener("timeupdate",this.onPlaying)},onPlaying:function(){this.state.isPreviewReady||this.setState({isPreviewReady:!0})},getInstance:function(){return this.refs.videoInstance.getDOMNode()},removeVideoSecurely:function(){var a=this.getInstance();a.pause(),b.forEach(a.children,function(a){"source"===a.nodeName.toLowerCase()&&a.setAttribute("src","")}),a.load()},getMediaType:function(){return j.getMediaType(this.props.data)},getBackgroundColor:function(){var a=j.getColorValue(this.getEditorAPI(),this.props.data.color);return{backgroundColor:a}},getBackgroundStyle:function(a){var e,b=this.props.data,d=a===this.mediaTypes.VIDEO?b.mediaRef.posterImageRef:b.mediaRef;if(b.fittingType===i.fittingTypes.LEGACY_BG_FIT_AND_TILE||b.fittingType===i.fittingTypes.TILE){var h=j.isSmallerFromContainer(d.width,d.height,f,g);e=h?i.fittingTypes.TILE:i.fittingTypes.FIT_AND_TILE}else e=i.fittingTypes.SCALE_TO_FILL;var k=j.getImageDisplayData(e,b.alignType,d.uri,d.width,d.height,f,g,85),l=k.css.container;return l.backgroundImage="url("+c.url.joinURL(j.MEDIA_URL_PREFIX,k.uri)+")",l.opacity=d.opacity,l},getVideoSource:function(a){var b=this.props.data.mediaRef,d=b.videoId,e=k(b.qualities)||b.qualities[0];return c.url.joinURL(j.VIDEO_URL_PREFIX,d,e.quality,a,"file."+a)},getVideoStyle:function(){return{width:f,height:g,opacity:this.props.data.mediaRef.opacity}},getSecInMin:function(){var a=this.props.data.mediaRef.duration,b=a%60,c=parseInt(a/60,10);return c+":"+(10>b?"0"+b:b)},getMediaCaption:function(){var a=this.props.data.mediaRef.title;return a||""},render:e})}),define("backgroundPresets/components/backgroundPresetSection",["react","lodash","core","util","color","backgroundPresets/components/backgroundPresetSection.rt","backgroundPresets/components/mediaPreview"],function(a,b,c,d,e,f,g){"use strict";var h=d.imageTransform.fittingTypes,i=d.imageTransform.alignTypes,j=d.backgroundPanelUtils,k="#ffffff",l=[{thumbWidth:238,thumbHeight:58},{thumbWidth:110,thumbHeight:58},{thumbWidth:68,thumbHeight:50},{thumbWidth:88,thumbHeight:59}];return a.createClass({displayName:"backgroundPresetSection",mixins:[c.mixins.editorAPIMixin],propTypes:{title:a.PropTypes.string,infoTooltip:a.PropTypes.string,onSelectPreset:a.PropTypes.func,columns:a.PropTypes.number,desktopPresets:a.PropTypes.array.isRequired,mobilePresets:a.PropTypes.array},mediaTypes:j.getMediaTypes(),getInitialState:function(){var a=this.props.columns-1||0;return{thumbWidth:l[a].thumbWidth,thumbHeight:l[a].thumbHeight}},componentWillReceiveProps:function(a){var b=a.columns-1||0;this.setState({thumbWidth:l[b].thumbWidth,thumbHeight:l[b].thumbHeight})},getMediaType:function(a){return j.getMediaType(a.ref)},getPresetData:function(){return this.getEditorAPI().isMobileEditor()?this.props.mobilePresets||{}:this.props.desktopPresets},getMediaPreviewComp:function(b){return this.getMediaType(b)!==this.mediaTypes.COLOR?a.createElement(g,{data:b.ref}):null},getThumbStyle:function(a){var e,c={},f=h.SCALE_TO_FILL,g=i.CENTER,l=this.getMediaType(a);if(a.thumbnail&&a.thumbnail.uri&&a.thumbnail.width&&a.thumbnail.height&&(e=b.omit(a.thumbnail,"title")),l!==this.mediaTypes.COLOR&&!e){if(e=l===this.mediaTypes.VIDEO?a.ref.mediaRef.posterImageRef:a.ref.mediaRef,a.ref.fittingType===h.LEGACY_BG_FIT_AND_TILE||a.ref.fittingType===h.TILE){var m=j.isSmallerFromContainer(e.width,e.height,this.state.thumbWidth,this.state.thumbHeight);f=m?h.TILE:h.FIT_AND_TILE}else f=h.SCALE_TO_FILL;g=a.ref.alignType}if(e){var n=j.getImageDisplayData(f,g,e.uri,e.width,e.height,this.state.thumbWidth,this.state.thumbHeight,90);c=n.css.container,c.backgroundImage="url("+d.url.joinURL(j.MEDIA_URL_PREFIX,n.uri)+")"}return c.backgroundColor=j.getColorValue(this.getEditorAPI(),a.ref.color||k),c.width=this.state.thumbWidth+"px",c.height=this.state.thumbHeight+"px",c},getOverlayStyle:function(a){var b=a.ref,c={},d=j.getColorValue(this.getEditorAPI(),b.colorOverlay);return d&&(c.backgroundColor=new e(d).alpha(b.colorOverlayOpacity||0).rgbaString()),c},selectPreset:function(a,c,d){this.props.onSelectPreset(b.cloneDeep(a),c,d)},render:function(){return f.apply(this)}})}),define("backgroundPresets",["backgroundPresets/components/backgroundPresetSection"],function(a){"use strict";return a});